/*! mpulse v0.0.2 */

!function(a){"use strict";function b(b,c){k||("object"==typeof XDomainRequest?(s=!0,k=function(){return new XDomainRequest}):"function"==typeof XMLHttpRequest||"object"==typeof XMLHttpRequest?k=function(){return new XMLHttpRequest}:"function"==typeof require?k=function(){var a=require("xmlhttprequest").XMLHttpRequest;return new a}:a&&"undefined"!=typeof a.ActiveXObject&&(k=function(){return new a.ActiveXObject("Microsoft.XMLHTTP")}));var d=k();"function"==typeof c&&(s?d.onload=function(){c(d.responseText)}:d.onreadystatechange=function(){4===d.readyState&&c(d.responseText)}),d.open("GET",b,!0),d.send()}function c(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0,c="x"===a?b:3&b|8;return c.toString(16)})}function d(a,b,c){if("undefined"==typeof CryptoJS||"function"!=typeof CryptoJS.HmacSHA256)return"";var d="key="+a+"&t="+c;return CryptoJS.HmacSHA256(d,b).toString()}function e(e,f,g){function h(b){return-1!==b.indexOf("http://")||-1!==b.indexOf("https://")?b:(V?b="https:"+b:"undefined"==typeof a?-1===b.indexOf("http:")&&(b="http:"+b):"undefined"!=typeof a&&"file:"===a.location.protocol&&-1===b.indexOf("http:")&&(b="http:"+b),b)}function i(){var a=U,b=+new Date;return a+=-1!==a.indexOf("?")?"&":"?",a+="key="+S,a+="&t="+b,a+="&s="+d(S,T,b),h(a)}function j(){var a=W.beacon_url;return h(a)}function k(a){try{var b=JSON.parse(a);for(var c in b)b.hasOwnProperty(c)&&(W[c]=b[c])}catch(d){return void(Y=!1)}if(da||M(W.session_id),ea={},ga={},ca={},W.PageParams){var e=W.PageParams.customMetrics,f=W.PageParams.customTimers,g=W.PageParams.customDimensions;if(e)for(r=0;r<e.length;r++){var h=e[r];ea[h.name]=h.label}if(f)for(r=0;r<f.length;r++){var i=f[r];ga[i.name]=i.label}if(g)for(r=0;r<g.length;r++){var j=g[r];ca[j.name]=j.label}}Y=!0,X=!0,setTimeout(p,m),l(w)}function p(){if(""!==U){var a=i();X&&(a+="&r="),b(a,k)}}function s(){var a={};for(var b in ba)ba.hasOwnProperty(b)&&(a[b]=ba[b]);return a}function v(a,b,c){Z.push({type:a,name:b,value:c,group:_,ab:aa,dimensions:s(),when:+new Date})}function w(a){if(0!==Z.length){if(!Y)return void((!$||a)&&($=!0,setTimeout(function(){w(!0)},n)));var b=Z.shift(),c=b.type,d=b.name,e=b.value,f={};"boolean"!=typeof b.group&&(f["h.pg"]=b.group),"boolean"!=typeof b.ab&&(f["h.ab"]=b.ab),f.when=b.when;for(var g in b.dimensions)b.dimensions.hasOwnProperty(g)&&"undefined"!=typeof ca[g]&&(f[ca[g]]=b.dimensions[g]);"metric"===c?"undefined"!=typeof ea[d]&&(f[ea[d]]=e,x(f)):"timer"===c&&"undefined"!=typeof ga[d]&&(f.t_other=ga[d]+"|"+e,x(f)),l(w)}}function x(a){a.d=W.site_domain,a["h.key"]=W["h.key"],a["h.d"]=W["h.d"],a["h.cr"]=W["h.cr"],a["h.t"]=W["h.t"],a["http.initiator"]="api",a["rt.start"]="api",da!==!1&&(a["rt.si"]=da,a["rt.ss"]=Math.round(ia+u),a["rt.sl"]=ja),a.api=1,a["api.v"]=2,a["api.l"]="js",a["api.lv"]=o,R("before_beacon",a);var c=[];for(var d in a)a.hasOwnProperty(d)&&c.push(encodeURIComponent(d)+"="+(void 0===a[d]||null===a[d]?"":encodeURIComponent(a[d])));var e=j(),f=e+(e.indexOf("?")>-1?"&":"?")+c.join("&");R("beacon",a),b(f)}function y(a){return"string"!=typeof a?-1:(ha++,fa[ha]={time:t(),name:a},ha)}function z(a){if("number"!=typeof a||0>a)return-1;var b=fa[a],c=0;return b?(c=Math.round(t()-b.time),A(b.name,c),delete fa[a],c):-1}function A(a,b){return"string"!=typeof a?-1:"number"!=typeof b||0>b?-1:(b=Math.round(b),v("timer",a,b),l(w),b)}function B(a,b){"string"==typeof a&&("undefined"==typeof b||"number"==typeof b)&&("undefined"==typeof b&&(b=1),v("metric",a,b),l(w))}function C(a){"string"==typeof a&&(_=a)}function D(){return _}function E(){_=!1}function F(a){return"string"!=typeof a?!1:/^[a-zA-Z0-9_ -]{1,25}$/.test(a)===!1?!1:(aa=a,!0)}function G(){return aa}function H(){aa=!1}function I(a,b){return"undefined"!=typeof a?"undefined"==typeof b?void J(a):void(ba[a]=b):void 0}function J(a){"undefined"!=typeof a&&"undefined"!=typeof ba[a]&&delete ba[a]}function K(a){("string"==typeof a||"number"==typeof a)&&("number"==typeof a&&(a=""+a),da=a)}function L(){return da}function M(a){return K(a||c()),O(0),L()}function N(){ja++}function O(a){"number"!=typeof a||0>a||(ja=a)}function P(){return ja}function Q(a,b){ka.hasOwnProperty(a)&&"function"==typeof b&&ka[a].push(b)}function R(a,b){for(var c=0;c<ka[a].length;c++)ka[a][c](b)}g=g||{};var S=e,T=f,U="//c.go-mpulse.net/api/v2/config.json",V=!1,W={},X=!1,Y=!1,Z=[],$=!1,_=!1,aa=!1,ba={},ca={},da=!1,ea={},fa={},ga={},ha=-1,ia=t(),ja=0,ka={};for(r=0;r<q.length;r++)ka[q[r]]=[];"undefined"!=typeof g.configUrl&&(U=g.configUrl),g.forceSSL&&(V=!0),p();var la={startTimer:y,stopTimer:z,sendTimer:A,sendMetric:B,setPageGroup:C,getPageGroup:D,resetPageGroup:E,setABTest:F,getABTest:G,resetABTest:H,setDimension:I,resetDimension:J,setSessionID:K,getSessionID:L,startSession:M,incrementSessionLength:N,setSessionLength:O,getSessionLength:P,subscribe:Q,parseConfig:k};return la}function f(){return x.mPulse=y,w}function g(a,b,c){if(c=c||{},"undefined"!=typeof c.name&&"undefined"!=typeof A[c.name])return A[c.name];var d=e(a,b,c);if(z===!1){z=d;for(var f=0;f<p.length;f++){var g=p[f];w[g]=z[g]}}return"undefined"!=typeof c.name&&(A[c.name]=d),d}function h(a){return A[a]}function i(){}function j(a){"undefined"!=typeof A[a]&&delete A[a]}var k,l,m=3e5,n=5e3,o="0.0.1",p=["startTimer","stopTimer","sendTimer","sendMetric","setPageGroup","getPageGroup","resetPageGroup","setABTest","getABTest","resetABTest","setDimension","resetDimension","setSessionID","getSessionID","startSession","incrementSessionLength","setSessionLength","getSessionLength","subscribe"],q=["before_beacon","beacon"],r=0,s=!1,t=!1,u=+new Date;if(l="undefined"!=typeof process&&"function"==typeof process.nextTick?process.nextTick.bind(process):"undefined"!=typeof a?a.setImmediate?a.setImmediate.bind(a):a.msSetImmediate?a.msSetImmediate.bind(a):a.webkitSetImmediate?a.webkitSetImmediate.bind(a):a.mozSetImmediate?a.mozSetImmediate.bind(a):function(a){setTimeout(a,10)}:function(a){setTimeout(a,10)},"undefined"!=typeof a)if("undefined"!=typeof a.performance&&"function"==typeof a.performance.now)t=a.performance.now.bind(a.performance);else if("undefined"!=typeof a.performance){var v=["webkitNow","msNow","mozNow"];for(r=0;r<v.length;r++)if("function"==typeof a.performance[v[r]]){t=a.performance[v[r]];break}}t||("undefined"!=typeof a&&a.performance&&a.performance.timing&&a.performance.timing.navigationStart&&(u=a.performance.timing.navigationStart),t="undefined"!=typeof Date&&Date.now?function(){return Date.now()-u}:function(){return+new Date-u});var w,x,y,z=!1,A={};for("undefined"!=typeof a&&(x=a,y=x.mPulse),w={version:o,noConflict:f,init:g,getApp:h,stop:j},r=0;r<p.length;r++)w[p[r]]=i;"function"==typeof define&&define.amd?define([],function(){return w}):"undefined"!=typeof module&&module.exports?module.exports=w:"undefined"!=typeof x&&(x.mPulse=w)}("undefined"!=typeof window?window:void 0);
//# sourceMappingURL=mpulse.min.js.map